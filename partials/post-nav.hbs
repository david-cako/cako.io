<div class="post-nav-outer">
    <script>
        /** Returns true if no modifier key is pressed and search is not shown
            for given keyboard event. */
        window.shouldNavigatePosts = (keyEvent) => {
            const searchShown = document.activeElement && 
                document.activeElement.classList.contains("cako-post-link");
            const modifier = keyEvent.altKey || keyEvent.ctrlKey ||
                keyEvent.metaKey || keyEvent.shiftKey;

            return !searchShown && !modifier;
        }

        /** Focuses post nav link element for given direction "left" or "right".
            if a post link is shown in that chronological direction. */
        window.focusPostNavLink = (direction) => {
            const navLinks = document.querySelectorAll(".post-nav-link");

            if (direction === "left") {
                if (navLinks[0]) {
                    navLinks[0].focus({preventScroll: true});
                }
            } else if (direction === "right") {
                if (navLinks[1]) {
                    navLinks[1].focus({preventScroll: true});
                }
            } else {
                throw new Error("Invalid direction passed to focusPostNavLink.")
            }
        }
    </script>
    <div id="post-nav-inner" class="post-nav inner">
        {{#prev_post}}
            <a href="{{url}}" class="cako-post-link post-nav-link">
                <div class="cako-post">
                    <div class="cako-post-title">{{title}}</div>
                    <div class="cako-post-date-outer">
                        <time class="cako-post-date" datetime="{{date format="YYYY-MM-DDTHH:mm:ss"}}">{{date format="D . M . YYYY"}}</time>
                    </div>
                </div>
            </a>
            <script>
                document.addEventListener("keydown", e => {
                    if (e.key == "ArrowLeft" && shouldNavigatePosts(e)) {
                        window.location = "{{url}}";
                        focusPostNavLink("left");
                    }
                });
            </script>
            <link rel="prefetch" href="{{url}}" />
        {{else}}
            <div></div>
        {{/prev_post}}
            
        {{#next_post}}
        <a href="{{url}}" class="cako-post-link post-nav-link">
            <div class="cako-post right">
                <div class="cako-post-title">{{title}}</div>
                <div class="cako-post-date-outer">
                    <time class="cako-post-date" datetime="{{date format="YYYY-MM-DDTHH:mm:ss"}}">{{date format="D . M . YYYY"}}</time>
                </div>
            </div>
        </a>

        <script>
            document.addEventListener("keydown", e => {
                if (e.key == "ArrowRight" && shouldNavigatePosts(e)) {
                    window.location = "{{url}}";
                    focusPostNavLink("right");
                }
            });
        </script>
        <link rel="prefetch" href="{{url}}" />
        {{/next_post}}
    </div>
</div>